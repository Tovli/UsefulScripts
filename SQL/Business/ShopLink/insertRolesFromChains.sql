set identity_insert roles on
insert into roles (roleid, rolename)
select chainid as roleid, chainName as rolename
from chains
where chainid not in (select roleid from roles)
and chainid in (100012,300053,300121,300057,100020,100008,300251,300071,300224,100015,90000,300105,100012,100016,300182,300183,300741,300224,100015,300105,100010,300224,300495,100041,100020,100016)
union
select chaingroupid as roleid, chaingroupName as rolename
from chaingroups
where chaingroupid not in (select roleid from roles)
and chaingroupid in (100012,300053,300121,300057,100020,100008,300251,300071,300224,100015,90000,300105,100012,100016,300182,300183,300741,300224,100015,300105,100010,300224,300495,100041,100020,100016)
set identity_insert roles off


insert into rolechains (roleid, chainid)
select roleid, chainid
from chains c, roles r
where chainid not in (select chainid from rolechains where roleid = r.roleid)
and (c.chainid = r.roleid or c.chainGroupid = r.roleid)
and roleid not in (100005,
100010,
100023,
100055,
300733)
and chainid > 40

insert into roleshops (roleid, shopid)
select roleid, shopid
from shops s join chains c on s.chainid = c.chainid, roles r
where shopid not in (select shopid from roleshops where roleid = r.roleid)
and (c.chainid = r.roleid or c.chainGroupid = r.roleid)
and (c.chainid in (300573,300731,300528,300554,300651,300567,300398,300665,300742,300080,300079,300335,300409,300341,300586,300143,300411,300640,300533,300504,300511,300621,300005,300607,300321,300445,300531,300555,300428,300246,300637,300163,300644,300169,300092,300164,300601,300036,300675,300631,300727,300647,300653,300715,300649,300322,300157,300654,300804,300567,300407,300677,300157,300087,100015,300730,300696,300539,300082,300325,300638,300458,300287,300306,300247,300004,300805,300716,300738,300532,300452,300111,300631,300085,300082,300129,300667,300809,300138,300635,300340,300024,300312,300095,300689,300092,300312,300596,300494,300603,300590,300657,300310,300404,300469,300142,300144)
or c.chaingroupid in (300573,300731,300528,300554,300651,300567,300398,300665,300742,300080,300079,300335,300409,300341,300586,300143,300411,300640,300533,300504,300511,300621,300005,300607,300321,300445,300531,300555,300428,300246,300637,300163,300644,300169,300092,300164,300601,300036,300675,300631,300727,300647,300653,300715,300649,300322,300157,300654,300804,300567,300407,300677,300157,300087,100015,300730,300696,300539,300082,300325,300638,300458,300287,300306,300247,300004,300805,300716,300738,300532,300452,300111,300631,300085,300082,300129,300667,300809,300138,300635,300340,300024,300312,300095,300689,300092,300312,300596,300494,300603,300590,300657,300310,300404,300469,300142,300144))